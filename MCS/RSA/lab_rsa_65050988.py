# ABSTRACTION
def is_prime(n):
    if (n == 2): return True
    if (n % 2 == 0): return False
    for i in range(3, n, 2):
        if (n % i == 0): return False
    return True

def find_factor_special(n):
        for i in range(2, n):
            if (n % i == 0 and is_prime(i) and is_prime(n // i)):
                return i
            

def find_D(phi, E):
    for i in range(1, phi):
        if (((i * E) - 1) % phi == 0):
        # if (((i * E)) % phi == 1):
            return i

# Decrypt
def get_number_decrypt(C_arr, D, n):
    Message_from_decrypt = []
    for i, c in enumerate(C_arr):
        Message_from_decrypt.append((c ** D) % n) 
    return Message_from_decrypt

def get_decrypted_print_msg(msg_num):
    real_msg = ""
    for i, ascii_char in enumerate(msg_num):
        real_msg += chr(ascii_char)
    return real_msg



# IMPLEMENTATION
def decode_rsa(n, E, cypher):
    p = find_factor_special(n)
    q = n // p
    phi = (p - 1) * (q - 1)
    D = find_D(phi, E)
    print("p is ", p)
    print("q is ", q)
    print("phi is ", phi)
    print("D is ", D)
    msg_num = get_number_decrypt(cypher, D, n)
    msg = get_decrypted_print_msg(msg_num)
    # print(msg_num)
    print(msg)

# Secrete Quote 0
n = 350627
E = 189983
cypher = [290137,115668,206422,231298,70986,124596,206422,54735,70986,145791,246571,303979,206422,303979,66717,293299,274570,206422,151451,255202,142621,293299,142621,259674,206422,231298,70986,124596,206422,272374,66717,145791,246571,303979,206422,272374,151451,274570,66717,303979,274570,206422,66717,206422,115668,124596,303979,124596,151451,274570,281015]
decode_rsa(n, E, cypher)

# Secrete Quote 1
n = 253031
E = 33311
cypher = [192718, 44207, 92345, 198194, 209885, 145673, 158195, 162891, 209885, 197432, 251143, 174163, 92345, 209885, 162891, 154788, 179792, 209885, 120588, 44207, 98836, 120588, 132369, 114740, 209885, 105496, 44207, 92345, 198194, 209885, 120588, 44207, 92345, 209885, 197432, 98836, 157424, 92345, 209885, 92345, 198194, 43326, 114740, 205085]
decode_rsa(n, E, cypher)

# Secrete Quote 2
n = 442523
E = 319699
cypher = [224476, 294163, 367725, 367725, 216835, 367725, 135507, 254755, 303589, 135507, 216835, 218849, 416081, 406146, 416081, 90895, 90895, 416081, 299359, 294163, 39364, 216835, 180334, 90895, 416081, 410593, 367725, 135507, 406146, 39364, 216835, 218849, 416081, 216835, 218849, 416081, 406146, 416081, 90895, 90895, 416081, 299359, 294163, 39364, 216835, 406146, 135507, 431006]
decode_rsa(n, E, cypher)

# Secrete Quote 3
n = 119387
E = 101533
cypher = [86359, 81019, 114792, 116312, 34966, 81019, 92384, 57020, 73822, 15671, 114792, 57020, 110149, 57446, 116159, 72045, 96789, 57020, 96789, 15671, 84595, 114792, 73822, 57020, 86867, 114792, 33756, 81019, 96789, 15671, 83707, 116159, 23742, 57020, 83707, 33756, 116312, 114792, 84595, 96789, 57446, 116159, 96789, 57020, 57446, 73822, 57446, 59751, 92384, 57020, 110149, 57446, 116159, 57020, 116159, 81019, 31823, 81019, 84595, 57020, 15671, 114792, 116312, 81019, 57020, 96789, 114792, 57020, 110149, 15671, 57446, 116159, 23742, 81019, 57020, 57446, 116159, 59751, 96789, 15671, 83707, 116159, 23742, 57719, ]
decode_rsa(n, E, cypher)

# Secrete Quote 4
n = 1133
E = 613
cypher = [805, 928, 414, 110, 622, 414, 110, 515, 32, 121, 111, 838, 348,526, 822, 32, 110, 111, 45, 515, 111, 111, 100, 32, 509, 110, 100, 32, 531, 111, 526, 425, 928, 520, 822, 939, 939, 32, 414, 939, 32, 425, 928, 822, 32, 531, 111, 526, 939, 425, 32, 425, 928, 414, 110, 515, 32, 121, 111, 838, 32, 99, 509, 110, 32, 100, 111, 767]
decode_rsa(n, E, cypher)

# Secrete Quote 5
n = 173939
E = 419
cypher = [22015, 79396, 72281, 44319, 63140, 96864, 25396, 73635, 148871, 62908, 168859, 44319, 15713, 96864, 70703, 44319, 172672, 72281, 25396, 151324, 72281, 168793, 70703, 7670, 44319, 65711, 43567, 70703, 44319, 109499, 70703, 62908, 168859, 44319, 70703, 79396, 72281, 25396, 72281, 44319, 151324, 96864, 25396, 44319, 43567, 168859, 44319, 70703, 25396, 154341, 109499, 15713, 145588, 44319, 70703, 79396, 72281, 44319, 65711, 72281, 168859, 70703, 44319, 109499, 70703, 44319, 168793, 65557, 15713, 87617, 44319, 22015, 79396, 65557, 70703, 62908, 168859, 44319, 63140, 79396, 65557, 70703, 44319, 135326, 65557, 52568, 72281, 168859, 44319, 109499, 70703, 44319, 168859, 96864, 44319, 148871, 65557, 135326, 15713, 44319, 65711, 72281, 65557, 43567, 70703, 109499, 151324, 43567, 73635, 87617]
decode_rsa(n, E, cypher)